{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "124e5672",
   "metadata": {},
   "source": [
    "# Custom Chatbot Project"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2a4a94b3",
   "metadata": {},
   "source": [
    "TODO: In this cell, write an explanation of which dataset you have chosen and why it is appropriate for this task\n",
    "\n",
    "I carefully chose the 2023 Fashion Trends dataset e.g., \"2023_fashion_trends.csv\" provided in the udacity workspace, for this Custom Chatbot project so that our fashion-focused chat interface can work with it. The information in this dataset carefully shows the complex changes that happen in modern fashion. It includes famous colour schemes, fabric choices, and other important fashion insights seen in 2023. This dataset fits perfectly intending to make it easier to create a complex chatbot that can meet the specific needs of fashion fans and people who work in the industry.\n",
    "\n",
    "Using a method known as RAG (Retrieval Augmented Generation), I will show how to employ a bespoke dataset with an LLM. Since the OpenAI model \"gpt-3.5-turbo-instruct\" is only known to have knowledge up to the year 2022, it would be appropriate to use this dataset to showcase the positive effect of RAG.\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "73e2759a",
   "metadata": {},
   "source": [
    "## 0. Essential Imports"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "bcf54d40",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a63d4c5f",
   "metadata": {},
   "source": [
    "## 1. Data Wrangling\n",
    "\n",
    "TODO: In the cells below, load your chosen dataset into a `pandas` dataframe with a column named `\"text\"`. This column should contain all of your text data, separated into at least 20 rows."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "c69b83a1",
   "metadata": {},
   "outputs": [],
   "source": [
    "df1 = pd.read_csv(\"data/2023_fashion_trends.csv\")\n",
    "df2 = pd.read_csv(\"data/character_descriptions.csv\")\n",
    "df3 = pd.read_csv(\"data/nyc_food_scrap_drop_off_sites.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "0a595980",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 82 entries, 0 to 81\n",
      "Data columns (total 3 columns):\n",
      " #   Column  Non-Null Count  Dtype \n",
      "---  ------  --------------  ----- \n",
      " 0   URL     82 non-null     object\n",
      " 1   Trends  82 non-null     object\n",
      " 2   Source  82 non-null     object\n",
      "dtypes: object(3)\n",
      "memory usage: 2.0+ KB\n"
     ]
    }
   ],
   "source": [
    "df1.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "d3885661",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>URL</th>\n",
       "      <th>Trends</th>\n",
       "      <th>Source</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Red. Glossy red hues took ...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Cargo Pants. Utilitarian w...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Sheer Clothing. \"Bare it a...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Denim Reimagined. From dou...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Shine For The Daytime. The...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                 URL  \\\n",
       "0  https://www.refinery29.com/en-us/fashion-trend...   \n",
       "1  https://www.refinery29.com/en-us/fashion-trend...   \n",
       "2  https://www.refinery29.com/en-us/fashion-trend...   \n",
       "3  https://www.refinery29.com/en-us/fashion-trend...   \n",
       "4  https://www.refinery29.com/en-us/fashion-trend...   \n",
       "\n",
       "                                              Trends  \\\n",
       "0  2023 Fashion Trend: Red. Glossy red hues took ...   \n",
       "1  2023 Fashion Trend: Cargo Pants. Utilitarian w...   \n",
       "2  2023 Fashion Trend: Sheer Clothing. \"Bare it a...   \n",
       "3  2023 Fashion Trend: Denim Reimagined. From dou...   \n",
       "4  2023 Fashion Trend: Shine For The Daytime. The...   \n",
       "\n",
       "                                              Source  \n",
       "0  7 Fashion Trends That Will Take Over 2023 — Sh...  \n",
       "1  7 Fashion Trends That Will Take Over 2023 — Sh...  \n",
       "2  7 Fashion Trends That Will Take Over 2023 — Sh...  \n",
       "3  7 Fashion Trends That Will Take Over 2023 — Sh...  \n",
       "4  7 Fashion Trends That Will Take Over 2023 — Sh...  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "acb3a9fd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 55 entries, 0 to 54\n",
      "Data columns (total 4 columns):\n",
      " #   Column       Non-Null Count  Dtype \n",
      "---  ------       --------------  ----- \n",
      " 0   Name         55 non-null     object\n",
      " 1   Description  55 non-null     object\n",
      " 2   Medium       55 non-null     object\n",
      " 3   Setting      55 non-null     object\n",
      "dtypes: object(4)\n",
      "memory usage: 1.8+ KB\n"
     ]
    }
   ],
   "source": [
    "df2.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "aed1a25f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Name</th>\n",
       "      <th>Description</th>\n",
       "      <th>Medium</th>\n",
       "      <th>Setting</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Emily</td>\n",
       "      <td>A young woman in her early 20s, Emily is an as...</td>\n",
       "      <td>Play</td>\n",
       "      <td>England</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Jack</td>\n",
       "      <td>A middle-aged man in his 40s, Jack is a succes...</td>\n",
       "      <td>Play</td>\n",
       "      <td>England</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Alice</td>\n",
       "      <td>A woman in her late 30s, Alice is a warm and n...</td>\n",
       "      <td>Play</td>\n",
       "      <td>England</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Tom</td>\n",
       "      <td>A man in his 50s, Tom is a retired soldier and...</td>\n",
       "      <td>Play</td>\n",
       "      <td>England</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Sarah</td>\n",
       "      <td>A woman in her mid-20s, Sarah is a free-spirit...</td>\n",
       "      <td>Play</td>\n",
       "      <td>England</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Name                                        Description Medium  Setting\n",
       "0  Emily  A young woman in her early 20s, Emily is an as...   Play  England\n",
       "1   Jack  A middle-aged man in his 40s, Jack is a succes...   Play  England\n",
       "2  Alice  A woman in her late 30s, Alice is a warm and n...   Play  England\n",
       "3    Tom  A man in his 50s, Tom is a retired soldier and...   Play  England\n",
       "4  Sarah  A woman in her mid-20s, Sarah is a free-spirit...   Play  England"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df2.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "9efc32d2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 576 entries, 0 to 575\n",
      "Data columns (total 25 columns):\n",
      " #   Column                       Non-Null Count  Dtype  \n",
      "---  ------                       --------------  -----  \n",
      " 0   Unnamed: 0                   576 non-null    int64  \n",
      " 1   borough                      576 non-null    object \n",
      " 2   ntaname                      576 non-null    object \n",
      " 3   food_scrap_drop_off_site     576 non-null    object \n",
      " 4   location                     335 non-null    object \n",
      " 5   hosted_by                    571 non-null    object \n",
      " 6   open_months                  576 non-null    object \n",
      " 7   operation_day_hours          576 non-null    object \n",
      " 8   website                      541 non-null    object \n",
      " 9   borocd                       576 non-null    int64  \n",
      " 10  councildist                  576 non-null    int64  \n",
      " 11  latitude                     335 non-null    float64\n",
      " 12  longitude                    335 non-null    float64\n",
      " 13  precinct                     576 non-null    int64  \n",
      " 14  object_id                    576 non-null    int64  \n",
      " 15  location_point               335 non-null    object \n",
      " 16  :@computed_region_yeji_bk3q  335 non-null    float64\n",
      " 17  :@computed_region_92fq_4b7q  335 non-null    float64\n",
      " 18  :@computed_region_sbqj_enih  335 non-null    float64\n",
      " 19  :@computed_region_efsh_h5xi  331 non-null    float64\n",
      " 20  :@computed_region_f5dn_yrer  335 non-null    float64\n",
      " 21  notes                        564 non-null    object \n",
      " 22  ct2010                       56 non-null     float64\n",
      " 23  bbl                          31 non-null     float64\n",
      " 24  bin                          31 non-null     float64\n",
      "dtypes: float64(10), int64(5), object(10)\n",
      "memory usage: 112.6+ KB\n"
     ]
    }
   ],
   "source": [
    "df3.info() # quite large dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "98f20a1e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>borough</th>\n",
       "      <th>ntaname</th>\n",
       "      <th>food_scrap_drop_off_site</th>\n",
       "      <th>location</th>\n",
       "      <th>hosted_by</th>\n",
       "      <th>open_months</th>\n",
       "      <th>operation_day_hours</th>\n",
       "      <th>website</th>\n",
       "      <th>borocd</th>\n",
       "      <th>...</th>\n",
       "      <th>location_point</th>\n",
       "      <th>:@computed_region_yeji_bk3q</th>\n",
       "      <th>:@computed_region_92fq_4b7q</th>\n",
       "      <th>:@computed_region_sbqj_enih</th>\n",
       "      <th>:@computed_region_efsh_h5xi</th>\n",
       "      <th>:@computed_region_f5dn_yrer</th>\n",
       "      <th>notes</th>\n",
       "      <th>ct2010</th>\n",
       "      <th>bbl</th>\n",
       "      <th>bin</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>Staten Island</td>\n",
       "      <td>Grasmere-Arrochar-South Beach-Dongan Hills</td>\n",
       "      <td>South Beach</td>\n",
       "      <td>21 Robin Road, Staten Island NY</td>\n",
       "      <td>Snug Harbor Youth</td>\n",
       "      <td>Year Round</td>\n",
       "      <td>Friday (Start Time: 1:30 PM - End Time:  4:30 PM)</td>\n",
       "      <td>snug-harbor.org</td>\n",
       "      <td>502</td>\n",
       "      <td>...</td>\n",
       "      <td>{'type': 'Point', 'coordinates': [-74.062991, ...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>10692.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Inwood</td>\n",
       "      <td>SE Corner of Broadway &amp; Academy Street</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Department of Sanitation</td>\n",
       "      <td>Year Round</td>\n",
       "      <td>24/7</td>\n",
       "      <td>www.nyc.gov/smartcomposting</td>\n",
       "      <td>112</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Download the app to access bins. Accepts all f...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Park Slope</td>\n",
       "      <td>Old Stone House Brooklyn</td>\n",
       "      <td>336 3rd St, Brooklyn, NY 11215</td>\n",
       "      <td>Old Stone House Brooklyn</td>\n",
       "      <td>Year Round</td>\n",
       "      <td>24/7 (Start Time: 24/7 - End Time:  24/7)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>306</td>\n",
       "      <td>...</td>\n",
       "      <td>{'type': 'Point', 'coordinates': [-73.984731, ...</td>\n",
       "      <td>2.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>17617.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>East Harlem (North)</td>\n",
       "      <td>SE Corner of Pleasant Avenue &amp; E 116 Street</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Department of Sanitation</td>\n",
       "      <td>Year Round</td>\n",
       "      <td>24/7</td>\n",
       "      <td>www.nyc.gov/smartcomposting</td>\n",
       "      <td>111</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Download the app to access bins. Accepts all f...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>Queens</td>\n",
       "      <td>Corona</td>\n",
       "      <td>Malcolm X FSDO</td>\n",
       "      <td>111-26 Northern Blvd, Flushing, NY 11368</td>\n",
       "      <td>NYC Compost Project Hosted by Big Reuse</td>\n",
       "      <td>Year Round</td>\n",
       "      <td>Tuesdays (Start Time: 12:00 PM - End Time:  2:...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>404</td>\n",
       "      <td>...</td>\n",
       "      <td>{'type': 'Point', 'coordinates': [-73.8630721,...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>14510.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Unnamed: 0        borough                                     ntaname  \\\n",
       "0           0  Staten Island  Grasmere-Arrochar-South Beach-Dongan Hills   \n",
       "1           1      Manhattan                                      Inwood   \n",
       "2           2       Brooklyn                                  Park Slope   \n",
       "3           3      Manhattan                         East Harlem (North)   \n",
       "4           4         Queens                                      Corona   \n",
       "\n",
       "                      food_scrap_drop_off_site  \\\n",
       "0                                  South Beach   \n",
       "1       SE Corner of Broadway & Academy Street   \n",
       "2                     Old Stone House Brooklyn   \n",
       "3  SE Corner of Pleasant Avenue & E 116 Street   \n",
       "4                               Malcolm X FSDO   \n",
       "\n",
       "                                   location  \\\n",
       "0           21 Robin Road, Staten Island NY   \n",
       "1                                       NaN   \n",
       "2            336 3rd St, Brooklyn, NY 11215   \n",
       "3                                       NaN   \n",
       "4  111-26 Northern Blvd, Flushing, NY 11368   \n",
       "\n",
       "                                 hosted_by open_months  \\\n",
       "0                        Snug Harbor Youth  Year Round   \n",
       "1                 Department of Sanitation  Year Round   \n",
       "2                 Old Stone House Brooklyn  Year Round   \n",
       "3                 Department of Sanitation  Year Round   \n",
       "4  NYC Compost Project Hosted by Big Reuse  Year Round   \n",
       "\n",
       "                                 operation_day_hours  \\\n",
       "0  Friday (Start Time: 1:30 PM - End Time:  4:30 PM)   \n",
       "1                                               24/7   \n",
       "2          24/7 (Start Time: 24/7 - End Time:  24/7)   \n",
       "3                                               24/7   \n",
       "4  Tuesdays (Start Time: 12:00 PM - End Time:  2:...   \n",
       "\n",
       "                       website  borocd  ...  \\\n",
       "0              snug-harbor.org     502  ...   \n",
       "1  www.nyc.gov/smartcomposting     112  ...   \n",
       "2                          NaN     306  ...   \n",
       "3  www.nyc.gov/smartcomposting     111  ...   \n",
       "4                          NaN     404  ...   \n",
       "\n",
       "                                      location_point  \\\n",
       "0  {'type': 'Point', 'coordinates': [-74.062991, ...   \n",
       "1                                                NaN   \n",
       "2  {'type': 'Point', 'coordinates': [-73.984731, ...   \n",
       "3                                                NaN   \n",
       "4  {'type': 'Point', 'coordinates': [-73.8630721,...   \n",
       "\n",
       "   :@computed_region_yeji_bk3q  :@computed_region_92fq_4b7q  \\\n",
       "0                          1.0                         14.0   \n",
       "1                          NaN                          NaN   \n",
       "2                          2.0                         27.0   \n",
       "3                          NaN                          NaN   \n",
       "4                          3.0                         21.0   \n",
       "\n",
       "   :@computed_region_sbqj_enih  :@computed_region_efsh_h5xi  \\\n",
       "0                         76.0                      10692.0   \n",
       "1                          NaN                          NaN   \n",
       "2                         50.0                      17617.0   \n",
       "3                          NaN                          NaN   \n",
       "4                         68.0                      14510.0   \n",
       "\n",
       "  :@computed_region_f5dn_yrer  \\\n",
       "0                        30.0   \n",
       "1                         NaN   \n",
       "2                        14.0   \n",
       "3                         NaN   \n",
       "4                        66.0   \n",
       "\n",
       "                                               notes  ct2010  bbl  bin  \n",
       "0                                                NaN     NaN  NaN  NaN  \n",
       "1  Download the app to access bins. Accepts all f...     NaN  NaN  NaN  \n",
       "2                                                NaN     NaN  NaN  NaN  \n",
       "3  Download the app to access bins. Accepts all f...     NaN  NaN  NaN  \n",
       "4                                                NaN     NaN  NaN  NaN  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df3.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "ea0993f2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>URL</th>\n",
       "      <th>Trends</th>\n",
       "      <th>Source</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Red. Glossy red hues took ...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Cargo Pants. Utilitarian w...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Sheer Clothing. \"Bare it a...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Denim Reimagined. From dou...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Shine For The Daytime. The...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77</th>\n",
       "      <td>https://www.whowhatwear.com/spring-summer-2023...</td>\n",
       "      <td>If lime green isn't your vibe, rest assured th...</td>\n",
       "      <td>Spring/Summer 2023 Fashion Trends: 21 Expert-A...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>78</th>\n",
       "      <td>https://www.whowhatwear.com/spring-summer-2023...</td>\n",
       "      <td>\"As someone who can clearly (not fondly) remem...</td>\n",
       "      <td>Spring/Summer 2023 Fashion Trends: 21 Expert-A...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79</th>\n",
       "      <td>https://www.whowhatwear.com/spring-summer-2023...</td>\n",
       "      <td>\"Combine this design shift with the fact that ...</td>\n",
       "      <td>Spring/Summer 2023 Fashion Trends: 21 Expert-A...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80</th>\n",
       "      <td>https://www.whowhatwear.com/spring-summer-2023...</td>\n",
       "      <td>Thought party season ended at the stroke of mi...</td>\n",
       "      <td>Spring/Summer 2023 Fashion Trends: 21 Expert-A...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>81</th>\n",
       "      <td>https://www.whowhatwear.com/spring-summer-2023...</td>\n",
       "      <td>\"This season, we saw the revival of the bubble...</td>\n",
       "      <td>Spring/Summer 2023 Fashion Trends: 21 Expert-A...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>82 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                  URL  \\\n",
       "0   https://www.refinery29.com/en-us/fashion-trend...   \n",
       "1   https://www.refinery29.com/en-us/fashion-trend...   \n",
       "2   https://www.refinery29.com/en-us/fashion-trend...   \n",
       "3   https://www.refinery29.com/en-us/fashion-trend...   \n",
       "4   https://www.refinery29.com/en-us/fashion-trend...   \n",
       "..                                                ...   \n",
       "77  https://www.whowhatwear.com/spring-summer-2023...   \n",
       "78  https://www.whowhatwear.com/spring-summer-2023...   \n",
       "79  https://www.whowhatwear.com/spring-summer-2023...   \n",
       "80  https://www.whowhatwear.com/spring-summer-2023...   \n",
       "81  https://www.whowhatwear.com/spring-summer-2023...   \n",
       "\n",
       "                                               Trends  \\\n",
       "0   2023 Fashion Trend: Red. Glossy red hues took ...   \n",
       "1   2023 Fashion Trend: Cargo Pants. Utilitarian w...   \n",
       "2   2023 Fashion Trend: Sheer Clothing. \"Bare it a...   \n",
       "3   2023 Fashion Trend: Denim Reimagined. From dou...   \n",
       "4   2023 Fashion Trend: Shine For The Daytime. The...   \n",
       "..                                                ...   \n",
       "77  If lime green isn't your vibe, rest assured th...   \n",
       "78  \"As someone who can clearly (not fondly) remem...   \n",
       "79  \"Combine this design shift with the fact that ...   \n",
       "80  Thought party season ended at the stroke of mi...   \n",
       "81  \"This season, we saw the revival of the bubble...   \n",
       "\n",
       "                                               Source  \n",
       "0   7 Fashion Trends That Will Take Over 2023 — Sh...  \n",
       "1   7 Fashion Trends That Will Take Over 2023 — Sh...  \n",
       "2   7 Fashion Trends That Will Take Over 2023 — Sh...  \n",
       "3   7 Fashion Trends That Will Take Over 2023 — Sh...  \n",
       "4   7 Fashion Trends That Will Take Over 2023 — Sh...  \n",
       "..                                                ...  \n",
       "77  Spring/Summer 2023 Fashion Trends: 21 Expert-A...  \n",
       "78  Spring/Summer 2023 Fashion Trends: 21 Expert-A...  \n",
       "79  Spring/Summer 2023 Fashion Trends: 21 Expert-A...  \n",
       "80  Spring/Summer 2023 Fashion Trends: 21 Expert-A...  \n",
       "81  Spring/Summer 2023 Fashion Trends: 21 Expert-A...  \n",
       "\n",
       "[82 rows x 3 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Let's work with the df1 then we can apply our method on df2 and df3\n",
    "df1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "2343a7be",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Spring/Summer 2023 Fashion Trends: 21 Expert-Approved Looks You Need to See'"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.iloc[77][\"Source\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "59aa2753",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'https://www.whowhatwear.com/spring-summer-2023-fashion-trends/'"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.iloc[77][\"URL\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "935deb2a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\"If lime green isn't your vibe, rest assured there was another bold hue that practically jumped off the runway and my screen, which was evident from the moment I began this lengthy research process. Striking red ensembles, where shades of saffron were styled top to toe, were present in the form of tights and tuxedos at Ferragamo, sharp tailoring at Alexander McQueen, impressive fringing at Bottega Veneta and tube dresses and leggings at Alaïa.\""
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.iloc[77][\"Trends\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "e1c832d8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>URL</th>\n",
       "      <th>Trends</th>\n",
       "      <th>Source</th>\n",
       "      <th>rawText</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Red. Glossy red hues took ...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "      <td>2023 Fashion Trend: Red. Glossy red hues took ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Cargo Pants. Utilitarian w...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "      <td>2023 Fashion Trend: Cargo Pants. Utilitarian w...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Sheer Clothing. \"Bare it a...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "      <td>2023 Fashion Trend: Sheer Clothing. \"Bare it a...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Denim Reimagined. From dou...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "      <td>2023 Fashion Trend: Denim Reimagined. From dou...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>https://www.refinery29.com/en-us/fashion-trend...</td>\n",
       "      <td>2023 Fashion Trend: Shine For The Daytime. The...</td>\n",
       "      <td>7 Fashion Trends That Will Take Over 2023 — Sh...</td>\n",
       "      <td>2023 Fashion Trend: Shine For The Daytime. The...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77</th>\n",
       "      <td>https://www.whowhatwear.com/spring-summer-2023...</td>\n",
       "      <td>If lime green isn't your vibe, rest assured th...</td>\n",
       "      <td>Spring/Summer 2023 Fashion Trends: 21 Expert-A...</td>\n",
       "      <td>If lime green isn't your vibe, rest assured th...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>78</th>\n",
       "      <td>https://www.whowhatwear.com/spring-summer-2023...</td>\n",
       "      <td>\"As someone who can clearly (not fondly) remem...</td>\n",
       "      <td>Spring/Summer 2023 Fashion Trends: 21 Expert-A...</td>\n",
       "      <td>\"As someone who can clearly (not fondly) remem...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79</th>\n",
       "      <td>https://www.whowhatwear.com/spring-summer-2023...</td>\n",
       "      <td>\"Combine this design shift with the fact that ...</td>\n",
       "      <td>Spring/Summer 2023 Fashion Trends: 21 Expert-A...</td>\n",
       "      <td>\"Combine this design shift with the fact that ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80</th>\n",
       "      <td>https://www.whowhatwear.com/spring-summer-2023...</td>\n",
       "      <td>Thought party season ended at the stroke of mi...</td>\n",
       "      <td>Spring/Summer 2023 Fashion Trends: 21 Expert-A...</td>\n",
       "      <td>Thought party season ended at the stroke of mi...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>81</th>\n",
       "      <td>https://www.whowhatwear.com/spring-summer-2023...</td>\n",
       "      <td>\"This season, we saw the revival of the bubble...</td>\n",
       "      <td>Spring/Summer 2023 Fashion Trends: 21 Expert-A...</td>\n",
       "      <td>\"This season, we saw the revival of the bubble...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>82 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                  URL  \\\n",
       "0   https://www.refinery29.com/en-us/fashion-trend...   \n",
       "1   https://www.refinery29.com/en-us/fashion-trend...   \n",
       "2   https://www.refinery29.com/en-us/fashion-trend...   \n",
       "3   https://www.refinery29.com/en-us/fashion-trend...   \n",
       "4   https://www.refinery29.com/en-us/fashion-trend...   \n",
       "..                                                ...   \n",
       "77  https://www.whowhatwear.com/spring-summer-2023...   \n",
       "78  https://www.whowhatwear.com/spring-summer-2023...   \n",
       "79  https://www.whowhatwear.com/spring-summer-2023...   \n",
       "80  https://www.whowhatwear.com/spring-summer-2023...   \n",
       "81  https://www.whowhatwear.com/spring-summer-2023...   \n",
       "\n",
       "                                               Trends  \\\n",
       "0   2023 Fashion Trend: Red. Glossy red hues took ...   \n",
       "1   2023 Fashion Trend: Cargo Pants. Utilitarian w...   \n",
       "2   2023 Fashion Trend: Sheer Clothing. \"Bare it a...   \n",
       "3   2023 Fashion Trend: Denim Reimagined. From dou...   \n",
       "4   2023 Fashion Trend: Shine For The Daytime. The...   \n",
       "..                                                ...   \n",
       "77  If lime green isn't your vibe, rest assured th...   \n",
       "78  \"As someone who can clearly (not fondly) remem...   \n",
       "79  \"Combine this design shift with the fact that ...   \n",
       "80  Thought party season ended at the stroke of mi...   \n",
       "81  \"This season, we saw the revival of the bubble...   \n",
       "\n",
       "                                               Source  \\\n",
       "0   7 Fashion Trends That Will Take Over 2023 — Sh...   \n",
       "1   7 Fashion Trends That Will Take Over 2023 — Sh...   \n",
       "2   7 Fashion Trends That Will Take Over 2023 — Sh...   \n",
       "3   7 Fashion Trends That Will Take Over 2023 — Sh...   \n",
       "4   7 Fashion Trends That Will Take Over 2023 — Sh...   \n",
       "..                                                ...   \n",
       "77  Spring/Summer 2023 Fashion Trends: 21 Expert-A...   \n",
       "78  Spring/Summer 2023 Fashion Trends: 21 Expert-A...   \n",
       "79  Spring/Summer 2023 Fashion Trends: 21 Expert-A...   \n",
       "80  Spring/Summer 2023 Fashion Trends: 21 Expert-A...   \n",
       "81  Spring/Summer 2023 Fashion Trends: 21 Expert-A...   \n",
       "\n",
       "                                              rawText  \n",
       "0   2023 Fashion Trend: Red. Glossy red hues took ...  \n",
       "1   2023 Fashion Trend: Cargo Pants. Utilitarian w...  \n",
       "2   2023 Fashion Trend: Sheer Clothing. \"Bare it a...  \n",
       "3   2023 Fashion Trend: Denim Reimagined. From dou...  \n",
       "4   2023 Fashion Trend: Shine For The Daytime. The...  \n",
       "..                                                ...  \n",
       "77  If lime green isn't your vibe, rest assured th...  \n",
       "78  \"As someone who can clearly (not fondly) remem...  \n",
       "79  \"Combine this design shift with the fact that ...  \n",
       "80  Thought party season ended at the stroke of mi...  \n",
       "81  \"This season, we saw the revival of the bubble...  \n",
       "\n",
       "[82 rows x 4 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Creating a separate `rawText` column for df1 \n",
    "df1[\"rawText\"] = df1[\"Trends\"]\n",
    "df1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "fb9babbb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>rawText</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2023 Fashion Trend: Red. Glossy red hues took ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2023 Fashion Trend: Cargo Pants. Utilitarian w...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2023 Fashion Trend: Sheer Clothing. \"Bare it a...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2023 Fashion Trend: Denim Reimagined. From dou...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2023 Fashion Trend: Shine For The Daytime. The...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77</th>\n",
       "      <td>If lime green isn't your vibe, rest assured th...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>78</th>\n",
       "      <td>\"As someone who can clearly (not fondly) remem...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79</th>\n",
       "      <td>\"Combine this design shift with the fact that ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80</th>\n",
       "      <td>Thought party season ended at the stroke of mi...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>81</th>\n",
       "      <td>\"This season, we saw the revival of the bubble...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>82 rows × 1 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                              rawText\n",
       "0   2023 Fashion Trend: Red. Glossy red hues took ...\n",
       "1   2023 Fashion Trend: Cargo Pants. Utilitarian w...\n",
       "2   2023 Fashion Trend: Sheer Clothing. \"Bare it a...\n",
       "3   2023 Fashion Trend: Denim Reimagined. From dou...\n",
       "4   2023 Fashion Trend: Shine For The Daytime. The...\n",
       "..                                                ...\n",
       "77  If lime green isn't your vibe, rest assured th...\n",
       "78  \"As someone who can clearly (not fondly) remem...\n",
       "79  \"Combine this design shift with the fact that ...\n",
       "80  Thought party season ended at the stroke of mi...\n",
       "81  \"This season, we saw the revival of the bubble...\n",
       "\n",
       "[82 rows x 1 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Dropping all the cols except the rawText\n",
    "df1 = df1.drop([\"URL\", \"Trends\", \"Source\"], axis=1)\n",
    "df1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "060cb6a4",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54d60a14",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2983ea99",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "ae769871",
   "metadata": {},
   "source": [
    "## 2. Custom Query Completion\n",
    "\n",
    "TODO: In the cells below, compose a custom query using your chosen dataset and retrieve results from an OpenAI `Completion` model. You may copy and paste any useful code from the course materials."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fd939ae0",
   "metadata": {},
   "source": [
    "### OpenAI Imports"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "8b6e1f75",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Thnaks to vocareum\n",
    "import openai\n",
    "openai.api_base = \"https://openai.vocareum.com/v1\"\n",
    "openai.api_key = \"YOUR API KEY\""
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c4bc7bf2",
   "metadata": {},
   "source": [
    "### First Query (Q)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "13f2dcd7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Sure! The current fashion trends can vary depending on the season, but some general trends include:\n",
      "\n",
      "1. Monochromatic outfits: Wearing one color from head to toe is a popular trend, especially in neutral shades like beige, white, and black.\n",
      "\n",
      "2. Oversized and boxy silhouettes: This trend focuses on loose-fitting and relaxed clothing, such as oversized blazers, loose trousers, and boxy tops.\n",
      "\n",
      "3. Trends from the 90s and early 2000s: Fashion is cyclical, and we're currently seeing a resurgence of trends from the 90s and early 2000s, such as chunky sneakers, slip dresses, and crop tops.\n",
      "\n",
      "4. Sustainability and eco-friendly fashion: As\n"
     ]
    }
   ],
   "source": [
    "Q1 = \"\"\"\n",
    "\"Let me know about the current fashion trends.\"\n",
    "\n",
    "\"\"\"\n",
    "answer = openai.Completion.create(\n",
    "    model=\"gpt-3.5-turbo-instruct\",\n",
    "    prompt=Q1,\n",
    "    max_tokens=150\n",
    ")[\"choices\"][0][\"text\"].strip()\n",
    "print(answer)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "c403f543",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "It is subjective and depends on personal taste, but one could say that the clothing in the fashion industry today is very colorful. Many designers are incorporating bold and vibrant colors into their collections, and there is a wide range of colors and prints available for consumers to choose from. Colorful clothing has become a popular trend in recent years, and it adds a fun and playful element to fashion. Overall, the fashion industry is becoming more and more diverse in terms of color choices, and it is safe to say that there is something for everyone in terms of color in today's fashion.\n"
     ]
    }
   ],
   "source": [
    "Q2 = \"\"\"\n",
    "\"How colorfull do you think the cloths are in today's fashion industry\"\n",
    "\n",
    "\"\"\"\n",
    "answer2 = openai.Completion.create(\n",
    "    model=\"gpt-3.5-turbo-instruct\",\n",
    "    prompt=Q2,\n",
    "    max_tokens=150\n",
    ")[\"choices\"][0][\"text\"].strip()\n",
    "print(answer2)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eae8cff8",
   "metadata": {},
   "source": [
    "### Embeddings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "b8fe9328",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>rawText</th>\n",
       "      <th>embeddings</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2023 Fashion Trend: Red. Glossy red hues took ...</td>\n",
       "      <td>[-0.020888978615403175, -0.022011762484908104,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2023 Fashion Trend: Cargo Pants. Utilitarian w...</td>\n",
       "      <td>[-0.001784870750270784, -0.02892744168639183, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2023 Fashion Trend: Sheer Clothing. \"Bare it a...</td>\n",
       "      <td>[-0.010351753793656826, -0.019288228824734688,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2023 Fashion Trend: Denim Reimagined. From dou...</td>\n",
       "      <td>[-0.015583238564431667, -0.0055076382122933865...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2023 Fashion Trend: Shine For The Daytime. The...</td>\n",
       "      <td>[-0.0049476479180157185, 0.0017557254759594798...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77</th>\n",
       "      <td>If lime green isn't your vibe, rest assured th...</td>\n",
       "      <td>[-0.0027922040317207575, -0.01823589950799942,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>78</th>\n",
       "      <td>\"As someone who can clearly (not fondly) remem...</td>\n",
       "      <td>[-0.01475916150957346, -0.0064850859344005585,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79</th>\n",
       "      <td>\"Combine this design shift with the fact that ...</td>\n",
       "      <td>[-0.020906761288642883, -0.025071939453482628,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80</th>\n",
       "      <td>Thought party season ended at the stroke of mi...</td>\n",
       "      <td>[-0.019836585968732834, -0.0223378948867321, -...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>81</th>\n",
       "      <td>\"This season, we saw the revival of the bubble...</td>\n",
       "      <td>[-0.030918996781110764, 0.002061266452074051, ...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>82 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                              rawText  \\\n",
       "0   2023 Fashion Trend: Red. Glossy red hues took ...   \n",
       "1   2023 Fashion Trend: Cargo Pants. Utilitarian w...   \n",
       "2   2023 Fashion Trend: Sheer Clothing. \"Bare it a...   \n",
       "3   2023 Fashion Trend: Denim Reimagined. From dou...   \n",
       "4   2023 Fashion Trend: Shine For The Daytime. The...   \n",
       "..                                                ...   \n",
       "77  If lime green isn't your vibe, rest assured th...   \n",
       "78  \"As someone who can clearly (not fondly) remem...   \n",
       "79  \"Combine this design shift with the fact that ...   \n",
       "80  Thought party season ended at the stroke of mi...   \n",
       "81  \"This season, we saw the revival of the bubble...   \n",
       "\n",
       "                                           embeddings  \n",
       "0   [-0.020888978615403175, -0.022011762484908104,...  \n",
       "1   [-0.001784870750270784, -0.02892744168639183, ...  \n",
       "2   [-0.010351753793656826, -0.019288228824734688,...  \n",
       "3   [-0.015583238564431667, -0.0055076382122933865...  \n",
       "4   [-0.0049476479180157185, 0.0017557254759594798...  \n",
       "..                                                ...  \n",
       "77  [-0.0027922040317207575, -0.01823589950799942,...  \n",
       "78  [-0.01475916150957346, -0.0064850859344005585,...  \n",
       "79  [-0.020906761288642883, -0.025071939453482628,...  \n",
       "80  [-0.019836585968732834, -0.0223378948867321, -...  \n",
       "81  [-0.030918996781110764, 0.002061266452074051, ...  \n",
       "\n",
       "[82 rows x 2 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "EMBEDDING_MODEL_NAME = \"text-embedding-ada-002\"\n",
    "batch_size = 100\n",
    "embeddings = []\n",
    "for i in range(0, len(df1), batch_size):\n",
    "    # Send text data to OpenAI model to get embeddings\n",
    "    response = openai.Embedding.create(\n",
    "        input=df1.iloc[i:i+batch_size][\"rawText\"].tolist(),\n",
    "        engine=EMBEDDING_MODEL_NAME\n",
    "    )\n",
    "    \n",
    "    # Add embeddings to list\n",
    "    embeddings.extend([data[\"embedding\"] for data in response[\"data\"]])\n",
    "\n",
    "# Add embeddings list to dataframe\n",
    "df1[\"embeddings\"] = embeddings\n",
    "df1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "6e36a600",
   "metadata": {},
   "outputs": [],
   "source": [
    "df1.to_csv(\"fashion-text-embeddings.csv\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9b411f0c",
   "metadata": {},
   "source": [
    "### F(x) - A function to find relevence of a input rawText for a given Query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "3689a419",
   "metadata": {},
   "outputs": [],
   "source": [
    "from openai.embeddings_utils import get_embedding, distances_from_embeddings\n",
    "\n",
    "def get_rows_sorted_by_relevance(question, df):\n",
    "    \"\"\"\n",
    "    Function that takes in a question string and a dataframe containing\n",
    "    rows of text and associated embeddings, and returns that dataframe\n",
    "    sorted from least to most relevant for that question\n",
    "    \"\"\"\n",
    "\n",
    "    # Get embeddings for the question text\n",
    "    question_embeddings = get_embedding(question, engine=EMBEDDING_MODEL_NAME)\n",
    "\n",
    "    # Making a copy of the dataframe and add a \"distances\" column containing\n",
    "    # the cosine distances between each row's embeddings and the\n",
    "    # embeddings of the question\n",
    "    df1_copy = df1.copy()\n",
    "    df1_copy[\"distances\"] = distances_from_embeddings(\n",
    "        question_embeddings,\n",
    "        df1_copy[\"embeddings\"].values,\n",
    "        distance_metric=\"cosine\"\n",
    "    )\n",
    "\n",
    "    # Sort the copied dataframe by the distances and return it\n",
    "    # (shorter distance = more relevant so we sort in ascending order)\n",
    "    df1_copy.sort_values(\"distances\", ascending=True, inplace=True)\n",
    "    return df1_copy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "ea0fbea2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>rawText</th>\n",
       "      <th>embeddings</th>\n",
       "      <th>distances</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>\"Every season, there is a trend that speaks to...</td>\n",
       "      <td>[-0.010633492842316628, -0.018795019015669823,...</td>\n",
       "      <td>0.157972</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>\"Leather jackets are leading the nouveau grung...</td>\n",
       "      <td>[-0.010424140840768814, 0.004091559909284115, ...</td>\n",
       "      <td>0.162606</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>The Tailored Look. This spring, I’m looking to...</td>\n",
       "      <td>[-0.023655513301491737, 0.006569489371031523, ...</td>\n",
       "      <td>0.165672</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2023 Fashion Trend: Red. Glossy red hues took ...</td>\n",
       "      <td>[-0.020888978615403175, -0.022011762484908104,...</td>\n",
       "      <td>0.169986</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>Modern Boho. This spring, I am excited to embr...</td>\n",
       "      <td>[-0.04759504646062851, -0.008400321938097477, ...</td>\n",
       "      <td>0.170813</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>The-Bigger-the-Better Bags. Gone are the days ...</td>\n",
       "      <td>[-0.011324513703584671, -0.0036169933155179024...</td>\n",
       "      <td>0.219885</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Romantic Femininity. Balletcore is here to sta...</td>\n",
       "      <td>[-0.04312363639473915, -0.012134474702179432, ...</td>\n",
       "      <td>0.223364</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>78</th>\n",
       "      <td>\"As someone who can clearly (not fondly) remem...</td>\n",
       "      <td>[-0.01475916150957346, -0.0064850859344005585,...</td>\n",
       "      <td>0.224557</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>\"Big bags have become a favourite among celebr...</td>\n",
       "      <td>[-0.016355499625205994, -0.0037190099246799946...</td>\n",
       "      <td>0.227357</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Oversized Bags. As cute as they can be, tiny b...</td>\n",
       "      <td>[-0.0017002830281853676, -0.006393798626959324...</td>\n",
       "      <td>0.230531</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>82 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                              rawText  \\\n",
       "63  \"Every season, there is a trend that speaks to...   \n",
       "69  \"Leather jackets are leading the nouveau grung...   \n",
       "31  The Tailored Look. This spring, I’m looking to...   \n",
       "0   2023 Fashion Trend: Red. Glossy red hues took ...   \n",
       "30  Modern Boho. This spring, I am excited to embr...   \n",
       "..                                                ...   \n",
       "37  The-Bigger-the-Better Bags. Gone are the days ...   \n",
       "15  Romantic Femininity. Balletcore is here to sta...   \n",
       "78  \"As someone who can clearly (not fondly) remem...   \n",
       "47  \"Big bags have become a favourite among celebr...   \n",
       "18  Oversized Bags. As cute as they can be, tiny b...   \n",
       "\n",
       "                                           embeddings  distances  \n",
       "63  [-0.010633492842316628, -0.018795019015669823,...   0.157972  \n",
       "69  [-0.010424140840768814, 0.004091559909284115, ...   0.162606  \n",
       "31  [-0.023655513301491737, 0.006569489371031523, ...   0.165672  \n",
       "0   [-0.020888978615403175, -0.022011762484908104,...   0.169986  \n",
       "30  [-0.04759504646062851, -0.008400321938097477, ...   0.170813  \n",
       "..                                                ...        ...  \n",
       "37  [-0.011324513703584671, -0.0036169933155179024...   0.219885  \n",
       "15  [-0.04312363639473915, -0.012134474702179432, ...   0.223364  \n",
       "78  [-0.01475916150957346, -0.0064850859344005585,...   0.224557  \n",
       "47  [-0.016355499625205994, -0.0037190099246799946...   0.227357  \n",
       "18  [-0.0017002830281853676, -0.006393798626959324...   0.230531  \n",
       "\n",
       "[82 rows x 3 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_rows_sorted_by_relevance(\"Let me know about the current fashion trends.\", df1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "7c1c8a96",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>rawText</th>\n",
       "      <th>embeddings</th>\n",
       "      <th>distances</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2023 Fashion Trend: Cobalt Blue. The strongest...</td>\n",
       "      <td>[-0.0069767870008945465, -0.021418340504169464...</td>\n",
       "      <td>0.170832</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77</th>\n",
       "      <td>If lime green isn't your vibe, rest assured th...</td>\n",
       "      <td>[-0.0027922040317207575, -0.01823589950799942,...</td>\n",
       "      <td>0.172305</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Bold Color Bottoms. As someone who tends to le...</td>\n",
       "      <td>[-0.014962133951485157, -0.006789395585656166,...</td>\n",
       "      <td>0.173321</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55</th>\n",
       "      <td>\"The movement could be traced back to Jonathan...</td>\n",
       "      <td>[-0.03091505914926529, -7.344771438511088e-05,...</td>\n",
       "      <td>0.175749</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52</th>\n",
       "      <td>I won't waste your time by quoting perhaps the...</td>\n",
       "      <td>[-0.026018904522061348, -0.0006309617892839015...</td>\n",
       "      <td>0.176198</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>61</th>\n",
       "      <td>\"As seen in Miu Miu's Milan Fashion Week show,...</td>\n",
       "      <td>[-0.03085167519748211, -0.007004522252827883, ...</td>\n",
       "      <td>0.231781</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Oversized Bags. As cute as they can be, tiny b...</td>\n",
       "      <td>[-0.0017002830281853676, -0.006393798626959324...</td>\n",
       "      <td>0.238077</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>\"Big bags have become a favourite among celebr...</td>\n",
       "      <td>[-0.016355499625205994, -0.0037190099246799946...</td>\n",
       "      <td>0.239173</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>74</th>\n",
       "      <td>I'm not one for necklaces, statement rings or ...</td>\n",
       "      <td>[-0.024490155279636383, 0.004563651047646999, ...</td>\n",
       "      <td>0.240939</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Sculptural Statement Earrings. For me, this sp...</td>\n",
       "      <td>[-0.03322990983724594, -0.004632764030247927, ...</td>\n",
       "      <td>0.258657</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>82 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                              rawText  \\\n",
       "6   2023 Fashion Trend: Cobalt Blue. The strongest...   \n",
       "77  If lime green isn't your vibe, rest assured th...   \n",
       "25  Bold Color Bottoms. As someone who tends to le...   \n",
       "55  \"The movement could be traced back to Jonathan...   \n",
       "52  I won't waste your time by quoting perhaps the...   \n",
       "..                                                ...   \n",
       "61  \"As seen in Miu Miu's Milan Fashion Week show,...   \n",
       "18  Oversized Bags. As cute as they can be, tiny b...   \n",
       "47  \"Big bags have become a favourite among celebr...   \n",
       "74  I'm not one for necklaces, statement rings or ...   \n",
       "27  Sculptural Statement Earrings. For me, this sp...   \n",
       "\n",
       "                                           embeddings  distances  \n",
       "6   [-0.0069767870008945465, -0.021418340504169464...   0.170832  \n",
       "77  [-0.0027922040317207575, -0.01823589950799942,...   0.172305  \n",
       "25  [-0.014962133951485157, -0.006789395585656166,...   0.173321  \n",
       "55  [-0.03091505914926529, -7.344771438511088e-05,...   0.175749  \n",
       "52  [-0.026018904522061348, -0.0006309617892839015...   0.176198  \n",
       "..                                                ...        ...  \n",
       "61  [-0.03085167519748211, -0.007004522252827883, ...   0.231781  \n",
       "18  [-0.0017002830281853676, -0.006393798626959324...   0.238077  \n",
       "47  [-0.016355499625205994, -0.0037190099246799946...   0.239173  \n",
       "74  [-0.024490155279636383, 0.004563651047646999, ...   0.240939  \n",
       "27  [-0.03322990983724594, -0.004632764030247927, ...   0.258657  \n",
       "\n",
       "[82 rows x 3 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_rows_sorted_by_relevance(\"How colorfull do you think the cloths are in today's fashion industry.\", df1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "04703af2",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "1dc21cc4",
   "metadata": {},
   "source": [
    "### F(x) - A function to create a prompt query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "bec5bbed",
   "metadata": {},
   "outputs": [],
   "source": [
    "import tiktoken\n",
    "\n",
    "def create_prompt(question, df, max_token_count):\n",
    "    \"\"\"\n",
    "    Given a question and a dataframe containing rows of text and their\n",
    "    embeddings, return a text prompt to send to a Completion model\n",
    "    \"\"\"\n",
    "    # Create a tokenizer that is designed to align with our embeddings\n",
    "    tokenizer = tiktoken.get_encoding(\"cl100k_base\")\n",
    "\n",
    "    # Count the number of tokens in the prompt template and question\n",
    "    prompt_template = \"\"\"\n",
    "Answer the question based on the context below, and if the question\n",
    "can't be answered based on the context, say \"I don't know\"\n",
    "\n",
    "Context: \n",
    "\n",
    "{}\n",
    "\n",
    "---\n",
    "\n",
    "Question: {}\n",
    "Answer:\"\"\"\n",
    "\n",
    "    current_token_count = len(tokenizer.encode(prompt_template)) + \\\n",
    "                            len(tokenizer.encode(question))\n",
    "\n",
    "    context = []\n",
    "    for text in get_rows_sorted_by_relevance(question, df)[\"rawText\"].values:\n",
    "\n",
    "        # Increase the counter based on the number of tokens in this row\n",
    "        text_token_count = len(tokenizer.encode(text))\n",
    "        current_token_count += text_token_count\n",
    "\n",
    "        # Add the row of text to the list if we haven't exceeded the max\n",
    "        if current_token_count <= max_token_count:\n",
    "            context.append(text)\n",
    "        else:\n",
    "            break\n",
    "\n",
    "    return prompt_template.format(\"\\n\\n###\\n\\n\".join(context), question)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "636136af",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Answer the question based on the context below, and if the question\n",
      "can't be answered based on the context, say \"I don't know\"\n",
      "\n",
      "Context: \n",
      "\n",
      "\"Every season, there is a trend that speaks to the inner maximalist in us. While autumn gave us lurid neons, biker boots and Y2K glamour, spring/summer 2023 presents something a little sweeter, and those with an aversion to all things 'pretty,' consider this your warning to look away now,\" says Remy Farrell, shopping editor at Who What Wear UK.\n",
      "\n",
      "###\n",
      "\n",
      "\"Leather jackets are leading the nouveau grunge trend, with Masha Popova, Knwls and Gucci bringing strong seasonal updates,\" says Gramston. See? Easy!\n",
      "\n",
      "---\n",
      "\n",
      "Question: Let me know about the current fashion trends.\n",
      "Answer:\n"
     ]
    }
   ],
   "source": [
    "print(create_prompt(\"Let me know about the current fashion trends.\", df1, 200))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "87e95280",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Answer the question based on the context below, and if the question\n",
      "can't be answered based on the context, say \"I don't know\"\n",
      "\n",
      "Context: \n",
      "\n",
      "2023 Fashion Trend: Cobalt Blue. The strongest color story to come out of Spring 2023 runways, cobalt blue has burst through the collections with the freshness of a sea mist on a morning day. Just bright enough to warrant a double take, yet subtle enough to be worked into daily wear, it's the type of deep blue that will excite even the most color-averse. Bonus points: It pairs well with Pantone's Viva Magenta.\n",
      "\n",
      "---\n",
      "\n",
      "Question: How colorfull do you think the cloths are in today's fashion industry.\n",
      "Answer:\n"
     ]
    }
   ],
   "source": [
    "print(create_prompt(\"How colorfull do you think the cloths are in today's fashion industry.\", df1, 200))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "acc830ad",
   "metadata": {},
   "source": [
    "### F(x) - A function to find answers to a query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "d0cdb3a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "COMPLETION_MODEL_NAME = \"gpt-3.5-turbo-instruct\"\n",
    "\n",
    "def answer_question(\n",
    "    question, df, max_prompt_tokens=1800, max_answer_tokens=100\n",
    "):\n",
    "    \"\"\"\n",
    "    Given a question, a dataframe containing rows of text, and a maximum\n",
    "    number of desired tokens in the prompt and response, return the\n",
    "    answer to the question according to an OpenAI Completion model\n",
    "    \n",
    "    If the model produces an error, return an empty string\n",
    "    \"\"\"\n",
    "    \n",
    "    prompt = create_prompt(question, df, max_prompt_tokens)\n",
    "    \n",
    "    try:\n",
    "        response = openai.Completion.create(\n",
    "            model=COMPLETION_MODEL_NAME,\n",
    "            prompt=prompt,\n",
    "            max_tokens=max_answer_tokens\n",
    "        )\n",
    "        return response[\"choices\"][0][\"text\"].strip()\n",
    "    except Exception as e:\n",
    "        print(e)\n",
    "        return \"\""
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1783f146",
   "metadata": {},
   "source": [
    "## 3. Custom Performance Demonstration\n",
    "\n",
    "TODO: In the cells below, demonstrate the performance of your custom query using at least 2 questions. For each question, show the answer from a basic `Completion` model query as well as the answer from your custom query."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4f11fdc0",
   "metadata": {},
   "source": [
    "### Question 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "4901c850",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "According to current fashion trends, sheer clothing, bold bursts of red, utilitarian detailing, tailored looks with minimalist touches, and modern boho vibes are popular for spring/summer 2023. Oversized and loose fitting silhouettes, denim reimagined, and retro and maximalist influences from the '90s and early 2000s are also trending. Some nostalgic trends from previous seasons, such as elevated basics and grunge/military-inspired styles, continue to be popular. Classic jewelry\n"
     ]
    }
   ],
   "source": [
    "custom_answer1 = answer_question(\"Let me know about the current fashion trends.\", df1)\n",
    "print(custom_answer1)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6e86e37c",
   "metadata": {},
   "source": [
    "### Question 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "6f646989",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Colorful enough to stand out and make a statement, but still subtle enough to be worked into daily wear.\n"
     ]
    }
   ],
   "source": [
    "custom_answer2 = answer_question(\"How colorfull do you think the cloths are in today's fashion industry.\", df1)\n",
    "print(custom_answer2)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9823dab7",
   "metadata": {},
   "source": [
    "### Let's compare answers with and without our custom prompt:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "11c07a54",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Let me know about the current fashion trends.\n",
      "\n",
      "Original Answer: Sure! The current fashion trends can vary depending on the season, but some general trends include:\n",
      "\n",
      "1. Monochromatic outfits: Wearing one color from head to toe is a popular trend, especially in neutral shades like beige, white, and black.\n",
      "\n",
      "2. Oversized and boxy silhouettes: This trend focuses on loose-fitting and relaxed clothing, such as oversized blazers, loose trousers, and boxy tops.\n",
      "\n",
      "3. Trends from the 90s and early 2000s: Fashion is cyclical, and we're currently seeing a resurgence of trends from the 90s and early 2000s, such as chunky sneakers, slip dresses, and crop tops.\n",
      "\n",
      "4. Sustainability and eco-friendly fashion: As\n",
      "Custom Answer:   According to current fashion trends, sheer clothing, bold bursts of red, utilitarian detailing, tailored looks with minimalist touches, and modern boho vibes are popular for spring/summer 2023. Oversized and loose fitting silhouettes, denim reimagined, and retro and maximalist influences from the '90s and early 2000s are also trending. Some nostalgic trends from previous seasons, such as elevated basics and grunge/military-inspired styles, continue to be popular. Classic jewelry\n",
      "\n",
      "How colorfull do you think the cloths are in today's fashion industry.\n",
      "Original Answer: It is subjective and depends on personal taste, but one could say that the clothing in the fashion industry today is very colorful. Many designers are incorporating bold and vibrant colors into their collections, and there is a wide range of colors and prints available for consumers to choose from. Colorful clothing has become a popular trend in recent years, and it adds a fun and playful element to fashion. Overall, the fashion industry is becoming more and more diverse in terms of color choices, and it is safe to say that there is something for everyone in terms of color in today's fashion.\n",
      "Custom Answer:   Colorful enough to stand out and make a statement, but still subtle enough to be worked into daily wear.\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(f\"\"\"\n",
    "Let me know about the current fashion trends.\n",
    "\n",
    "Original Answer: {answer}\n",
    "Custom Answer:   {custom_answer1}\n",
    "\n",
    "How colorfull do you think the cloths are in today's fashion industry.\n",
    "Original Answer: {answer2}\n",
    "Custom Answer:   {custom_answer2}\n",
    "\"\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2944e153",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.18"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
